Kernel module forked from [Antonio Galea](https://github.com/ant9000).

Updated to work with newer kernel releases.
